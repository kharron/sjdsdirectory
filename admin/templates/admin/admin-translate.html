<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">

	<title>Admin</title>


	<!-- Stylesheets -->
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
	<link rel="stylesheet" href="/static/css/style.css">

	<!-- GOOGLE FONTS -->
	<link href='http://fonts.googleapis.com/css?family=Raleway:400,700,600,800%7COpen+Sans:400italic,400,600,700' rel='stylesheet' type='text/css'>


	<!--[if IE 9]>
		<script src="js/media.match.min.js"></script>
	<![endif]-->
</head>

<body>
<div id="main-wrapper">

	<header id="header">
		<div class="header-top-bar">
			<div class="container">
				<!-- HEADER-LOGIN -->
				<div class="header-login">

					<a href="#" class=""><i class="fa fa-power-off"></i> Login</a>

					<div>
						<form action="#">
							<input type="text" class="form-control" placeholder="Username">
							<input type="password" class="form-control" placeholder="Password">
							<input type="submit" class="btn btn-default" value="Login">
							<a href="#" class="btn btn-link">Forgot Password?</a>
						</form>
					</div>

				</div> <!-- END .HEADER-LOGIN -->

				<!-- HEADER REGISTER -->
				<div class="header-register">
					<a href="#" class=""><i class="fa fa-plus-square"></i> Register</a>

					<div>
						<form action="#">
							<input type="text" class="form-control" placeholder="Username">
							<input type="email" class="form-control" placeholder="Email">
							<input type="password" class="form-control" placeholder="Password">
							<input type="submit" class="btn btn-default" value="Register">
						</form>
					</div>

				</div> <!-- END .HEADER-REGISTER -->

				<!-- HEADER-LOG0 -->
				<div class="header-logo text-center">
					<h2><a href="index.html">GL<i class="fa fa-globe"></i>BO</a></h2>
				</div>
				<!-- END HEADER LOGO -->

				<!-- HEADER-SOCIAL -->
				<div class="header-social">
					<a href="#">
						<span><i class="fa fa-share-alt"></i></span>
						<i class="fa fa-chevron-down social-arrow"></i>
					</a>

					<ul class="list-inline">
						<li class="active"><a href="#"><i class="fa fa-facebook-square"></i></a></li>
						<li><a href="#"><i class="fa fa-google-plus-square"></i></a></li>
						<li><a href="#"><i class="fa fa-twitter-square"></i></a></li>
						<li><a href="#"><i class="fa fa-linkedin-square"></i></a></li>
					</ul>
				</div>
				<!-- END HEADER-SOCIAL -->

				<!-- HEADER-LANGUAGE -->
				<div class="header-language">
					<a href="#">
						<span>EN</span>
						<i class="fa fa-chevron-down"></i>
					</a>

					<ul class="list-unstyled">
						<li class="active"><a href="#">EN</a></li>
						<li><a href="#">FR</a></li>
						<li><a href="#">PT</a></li>
						<li><a href="#">IT</a></li>
					</ul>
				</div> <!-- END HEADER-LANGUAGE -->

				<!-- CALL TO ACTION -->
				<div class="header-call-to-action">
					<a href="#" class="btn btn-default"><i class="fa fa-plus"></i> Add Listing</a>
				</div><!-- END .HEADER-CALL-TO-ACTION -->

			</div><!-- END .CONTAINER -->
		</div>
		<!-- END .HEADER-TOP-BAR -->

		<!-- HEADER SEARCH SECTION -->
		<div class="header-search fixed-height">
			<div class="header-search-bar">
        <form action="#">

          <div class="search-toggle">
            <div class="container">
              <div class="distance-range">
                <p>
                  <label for="amount-search">Distance:</label>
                  <input type="text" id="amount-search">
                </p>

                <div id="slider-range-search"></div>
              </div>  <!-- end #distance-range -->

              <div class="distance-range">
                <p>
                  <label for="amount-search">Days published:</label>
                  <input type="text" id="amount-search-day">
                </p>

                <div id="slider-range-search-day"></div>
              </div>  <!-- end #distance-range -->

              <p>Location:</p>
              <div class="select-country">
                <select class="" data-placeholder="-Select Country-">
                  <option value="option1">option 1</option>
                  <option value="option2">option 2</option>
                  <option value="option3">option 3</option>
                </select>
              </div>

              <div class="region">
                <input type="text" placeholder="-Region-">
              </div>

              <div class="address">
                <input type="text" placeholder="-Address-">
              </div>

              <div class="category-search">
                <select class="" data-placeholder="-Select category-">
                  <option value="option1">option 1</option>
                  <option value="option2">option 2</option>
                  <option value="option3">option 3</option>
                </select>
              </div>

              <button class="search-btn" type="submit"><i class="fa fa-search"></i></button>

            </div>
          </div>  <!-- END .search-toggle -->


          <div class="container">
            <button class="toggle-btn" type="submit"><i class="fa fa-bars"></i></button>

            <div class="search-value">
              <div class="keywords">
                <input type="text" class="form-control" placeholder="Keywords">
              </div>

              <div class="select-location">
                <select class="" data-placeholder="-Select location-">
                  <option value="option1">option 1</option>
                  <option value="option2">option 2</option>
                  <option value="option3">option 3</option>
                  <option value="option4">option 4</option>
                </select>
              </div>

              <div class="category-search">
                <select class="" data-placeholder="-Select category-">
                  <option value="option1">option 1</option>
                  <option value="option2">option 2</option>
                  <option value="option3">option 3</option>
                  <option value="option4">option 4</option>
                </select>
              </div>

              <button class="search-btn" type="submit"><i class="fa fa-search"></i></button>
            </div>
          </div> <!-- END .CONTAINER -->
        </form>
      </div> <!-- END .header-search-bar -->

			<div class="page-heading about-us-heading">
				<span></span> <!-- for dark-overlay on the bg -->

				<div class="container">
					<h1>Admin <span>SJDS</span></h1>

					<div class="heading-link">
						<a href="#">Home</a>

						<i>/</i>

						<a href="#">Admin</a>
					</div>

				</div> <!-- END .container-->
			</div> <!-- END .about-us-heading -->

		</div> <!-- END .SEARCH and slide-section -->


		<div class="header-nav-bar">
			<div class="container">
				<nav>

					<button><i class="fa fa-bars"></i></button>

					<ul class="primary-nav list-unstyled">
						<li><a href="#">Home<i class="fa fa-angle-down"></i></a>
							<ul>
								<li><a href="ihome-map-grid.html">Home-map(grid)</a></li>
								<li><a href="home-map-list.html">Home-map(list)</a></li>
								<li><a href="index.html">Home slider(view-1)</a></li>
								<li><a href="home-category.html">Home slider(view-2)</a></li>
							</ul>

						</li>

						<li class=""><a href="#">Company<i class="fa fa-angle-down"></i></a>

							<ul>
								<li><a href="company-profile.html">Company(Profile)</a></li>
								<li><a href="company-product.html">Company(Product)</a></li>
								<li><a href="company-portfolio.html">Company(Portfolio)</a></li>
                <li><a href="company-events.html">Company(Events)</a></li>
                <li><a href="company-blog.html">Company(Blog)</a></li>
                <li><a href="company-contact.html">Company(contact)</a></li>
							</ul>

						</li>

						<li><a href="sample-page.html">Sample Page</a></li>
						<li><a href="shortcodes.html">Shortcodes</a></li>

						<li class="">
							<a href="#">Blog<i class="fa fa-angle-down"></i></a>

							<ul>
								<li><a href="blog-list.html">Blog list</a></li>
                <li><a href="blog-post.html">Blog-post</a></li>
							</ul>

						</li>

						<li><a href="price-listing.html">Price Listing</a></li>
						<li class="bg-color"><a href="about-us.html">About Us</a></li>
						<li><a href="contact-us.html">Contact Us</a></li>
					</ul>
				</nav>
			</div> <!-- end .container -->
		</div> <!-- end .header-nav-bar -->
	</header> <!-- end #header -->

	<div id="page-content">
		<div class="container">
			<div class="page-content">
				<div class="row">
				<div class="row">
					<div class="col-sm-offset-2 col-sm-10"><h2>Edit a Business</h2></div>
					<form id="form-edit-business" class="form-horizontal" action="#">
						<div class="form-group">
							<label for="bBusiness" class="col-sm-2 control-label">Current Businesses</label>
							<div class="col-sm-10">
								<!-- Available Business -->
								<div id="place_select2"></div>
							</div>
						</div>
						<div class="form-group">
							<div class="col-sm-offset-2 col-sm-10">
								<button type="submit" id="editbtn" class="btn btn-default">Edit Business</button>
								<button type="submit" id="delbtn" class="btn btn-default">Delete Business</button>
							</div>
						</div>
					</form>
					<div class="col-sm-offset-2 col-sm-10"><h2>Anadir un negocio</h2></div>
					<form class="form-horizontal" action="/update_translate/" method="POST">
						<div class="form-group">
							<label for="bName" class="col-sm-2 control-label">Nombre de Negocio</label>
							<div class="col-sm-10">
								<input type="text" name="bName" class="input-border form-control" id="bName" placeholder="Nombre" />
							</div>
						</div>
						<div class="form-group">
							<label for="bDesc" class="col-sm-2 control-label">Descripcion de Negocio</label>
							<div class="col-sm-4">
								<textarea name="bDesc" class="input-border form-control" id="bDesc" rows="10"></textarea>
							</div>
							<div class="col-sm-6">
								<textarea name="nDesc" class="input-border form-control" id="nDesc" rows="10"></textarea>
							</div>
						</div>
						<div class="form-group">
							<label for="bProducts" class="col-sm-2 control-label">Products or Services</label>
							<div class="col-sm-4">
								<input type="text" name="bProducts" class="input-border form-control" id="bProducts" placeholder="Products must be seperated by commas" />
							</div>
							<div class="col-sm-6">
								<input type="text" name="nProducts" class="input-border form-control" id="nProducts" placeholder="Products must be seperated by commas" />
							</div>
						</div>
						<div class="form-group">
							<label for="bCategory" class="col-sm-2 control-label">Current Categories</label>
							<div class="col-sm-10">
								<!-- Available Categories -->
								<div id="place_select1"></div>
							</div>
						</div>
						<div class="form-group">
							<label for="bCategory" class="col-sm-2 control-label">Current Categories 2</label>
							<div class="col-sm-10">
								<!-- Available Categories -->
								<div id="place_select4"></div>
							</div>
						</div>
						<div class="form-group">
							<label for="bCategory" class="col-sm-2 control-label">Current Categories 3</label>
							<div class="col-sm-10">
								<!-- Available Categories -->
								<div id="place_select3"></div>
							</div>
						</div>
						<div class="form-group">
							<div class="col-sm-offset-2 col-sm-10">
								<input type="hidden" name="hidden-bid" id="hidden-bid" value="" />
								<button type="submit" id="add_btn" class="btn btn-default">Envia Negocio</button>
							</div>
						</div>
						</form>
				</div> <!-- end .add-company-form -->
			</div> <!-- end .page-content -->
		</div> <!-- end .container -->

	</div> <!-- end #page-content -->


	<footer id="footer">
		<div class="main-footer">

			<div class="container">
				<div class="row">

					<div class="col-md-3 col-sm-6">
						<div class="about-globo">
							<h3>About Globo</h3>

							<div class="footer-logo">
								<a href="#"><img src="img/footer_logo.png" alt=""></a>
								<span></span> <!-- This content for overlay effect -->
							</div>

							<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Proin nibh augue,
								suscipit a, scelerisque sed, lacinia in, mi. Cras vel lorem.</p>

						</div> <!-- End .about-globo -->
					</div> <!-- end Grid layout-->

					<div class="col-md-3 col-sm-6">
						<h3>Latest From Blog</h3>

						<div class="latest-post clearfix">
							<div class="post-image">
								<img src="img/content/latest_post_1.jpg" alt="">

								<p><span>12</span>Sep</p>
							</div>

							<h4><a href="#">Post Title Goes Here</a></h4>

							<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
						</div>

						<div class="latest-post clearfix">
							<div class="post-image">
								<img src="img/content/latest_post_2.jpg" alt="">

								<p><span>09</span>Sep</p>
							</div>

							<h4><a href="#">Post Title Goes Here</a></h4>

							<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
						</div>
					</div> <!-- end Grid layout-->

					<div class="col-md-3 col-sm-6 clearfix">
						<div class="popular-categories">
							<h3>Popular Categories</h3>

							<ul>
								<li><a href="#"><i class="fa fa-shopping-cart"></i>E-commerce</a></li>
								<li><a href="#"><i class="fa fa-paper-plane-o"></i>Entertainment</a></li>
								<li><a href="#"><i class="fa fa-cogs"></i>Industry</a></li>
								<li><a href="#"><i class="fa fa-book"></i>Libraries &amp; Public Office</a></li>
								<li><a href="#"><i class="fa fa-building-o"></i>Real Estate</a></li>
							</ul>
						</div> <!-- end .popular-categories-->
					</div> <!-- end Grid layout-->

					<div class="col-md-3 col-sm-6">
						<div class="newsletter">
							<h3>Newsletter</h3>

							<form action="#">
								<input type="Email" placeholder="Email address">
								<button><i class="fa fa-plus"></i></button>
							</form>

							<h3>Keep In Touch</h3>

							<ul class="list-inline">
								<li><a href="#"><i class="fa fa-facebook"></i></a></li>
								<li><a href="#"><i class="fa fa-twitter"></i></a></li>
								<li><a href="#"><i class="fa fa-google-plus"></i></a></li>
								<li><a href="#"><i class="fa fa-linkedin"></i></a></li>
							</ul>
						</div> <!-- end .newsletter-->

					</div> <!-- end Grid layout-->
				</div> <!-- end .row -->
			</div> <!-- end .container -->
		</div> <!-- end .main-footer -->

		<div class="copyright">
			<div class="container">
				<p>Copyright 2015 &copy; SJDS Directory. All rights reserved. Powered by  <a href="#">Kharron</a></p>

				<ul class="list-inline">
					<li><a href="#">Home</a></li>
					<li><a href="#">About Us</a></li>
					<li><a href="#">Blog</a></li>
					<li><a href="#">Pricing</a></li>
					<li><a href="#">Contact</a></li>
				</ul>
			</div> <!-- END .container -->
		</div> <!-- end .copyright-->
	</footer> <!-- end #footer -->

</div> <!-- end #main-wrapper -->

<!-- Scripts -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//code.jquery.com/ui/1.11.1/jquery-ui.js"></script>
<script src="/static/js/jquery.ba-outside-events.min.js"></script>
<script type="text/javascript" src="//maps.google.com/maps/api/js?sensor=true"></script>
<script src="/static/js/bootstrap.min.js"></script>
<script src="/static/js/owl.carousel.js"></script>
<script src="/static/js/scripts.js"></script>
<script>

	 function update_catlist(cat_json, div_name){
		 keys_arr = Object.keys(cat_json);
		 i = div_name.slice(-1);
		 $("#"+ div_name).replaceWith('<select id="' + div_name + '" name="cat' + i + '" class="form-control input-border"><option value="" select>Choose Category</option>');
			keys_arr.forEach(function(i){
			 $("#"+ div_name).append("<option value='" + i + "'>" + cat_json[i] + "</option>");
			});
		 $('#'+ div_name).append("</select>");
	 }

	 function get_biz_list(){
		$("#place_select2").replaceWith("<span id='place_select2' class='spinner'></span>");
		$.ajax({
			'type': 'GET',
			'url': 'http://api.sjdsdirectory.com/getbusinesses_es/',
			'success': function(list){
				cat_json = JSON.parse(list);
				update_catlist(cat_json, 'place_select2');
			}
		});
	 }
function get_cat_list(){
		$("#place_select").replaceWith("<span id='place_select' class='spinner'></span>");
		$.ajax({
			'type': 'GET',
			'url': 'http://api.sjdsdirectory.com/getcats/',
			'success': function(list){
				cat_json = JSON.parse(list);
				update_catlist(cat_json, 'place_select1');
				update_catlist(cat_json, 'place_select4');
				update_catlist(cat_json, 'place_select3');
			}
		});
	 }

	 function del_biz(bid){
		 bid = encodeURIComponent(bid);
		 $.ajax({
			 type: 'POST',
			 url: 'http://api.sjdsdirectory.com/delbusiness_es/',
			 data: 'bid=' + bid,
			 success: function(msg){
				 get_biz_list();
			 }
		 });
	 }

	function add_english_if_there(biz_name){
		biz_name = encodeURIComponent(biz_name);
		$.ajax({
			type: "POST",
			url: "http://api.sjdsdirectory.com/get_english_from_name/",
			data: "biz_name=" + biz_name,
			success: function(data){
				if (data){
					data = JSON.parse(data);
					$("#nProducts").val(data['products']);
					$("#nDesc").val(data['description']);
				}
			}
		});
	}

	function get_biz(bid){
		 bid = encodeURIComponent(bid);
		 $.ajax({
			 type: 'POST',
			 url: 'http://api.sjdsdirectory.com/editbusiness_es/',
			 data: 'bid=' + bid,
			 success: function(msg){
				 // Change to Edit Cat
				 biz_info = JSON.parse(msg);
				 prod_arr = biz_info['products'];
				 $("#bProducts").val(prod_arr);
				 $("#bName").val(biz_info['name']);
				 $("#bDesc").val(biz_info['description']);
				 $("#hidden-bid").val(biz_info['id']); 
				 $("#addbtn").attr("id", "updatebtn");
				 $("#updatebtn").html('Update Business');
				 //addMarker(biz_info['gps_lat'], biz_info['gps_long']);
				 add_english_if_there(biz_info['name']);
			 }
		 });
	 }

	$(document).ready(function(){
		get_biz_list();
		get_cat_list();

		$("body").on("blur", "#bName", function(){
			//alert("Ha");
		});

		$("body").on("click", "#updatebtn", function(e){
			e.preventDefault();
			var bName = encodeURIComponent($("#bName").val());
			var bDesc = encodeURIComponent($("#bDesc").val());
			var bEmail = encodeURIComponent($("#bEmail").val());
			var bWebsite = encodeURIComponent($("#bWebsite").val());
			var bLat = $("#bLat").val();
			var bLon = $("#bLon").val();
			var bCategory = $("#place_select").val();
			var bPhone = $("#bPhone").val();
			var bAltPhone = $("#bAltPhone").val();
			var bAltPhone2 = $("#bAltPhone2").val();
			var bProducts = $("#bProducts").val();
			var bid = $("#hidden-bid").val();
			data = "bid=" + bid + "&bName=" + bName + "&bDesc=" + bDesc + "&bEmail=" + bEmail + "&bWebsite=" + bWebsite + "&bLat=" + bLat + "&bLon=" + bLon + "&bCategory=" + bCategory + "&bPhone=" + bPhone + "&bAltPhone=" + bAltPhone + "&bAltPhone2=" + bAltPhone + "&bProducts=" + bProducts;
			$.ajax({
				"type": "POST",
				"url": "http://api.sjdsdirectory.com/updatebusiness/",
				"data": data,
				"success": function(msg){
					alert("Updated with id: " + msg);
				}
			});
		});

	  $("body").on("click", "#addbtn", function(e){
			e.preventDefault();
			alert("Adding");
			var bName = encodeURIComponent($("#bName").val());
			var bDesc = encodeURIComponent($("#bDesc").val());
			var bEmail = $("#bEmail").val();
			var bWebsite = $("#bWebsite").val();
			var bLat = $("#bLat").val();
			var bLon = $("#bLon").val();
			var bCategory = $("#place_select").val();
			var bPhone = $("#bPhone").val();
			var bAltPhone = $("#bAltPhone").val();
			var bAltPhone2 = $("#bAltPhone2").val();
			var bProducts = encodeURIComponent($("#bProducts").val());
			var facebook = encodeURIComponent($("#facebook").val());
			var twitter = encodeURIComponent($("#twitter").val());
			data = "bName=" + bName + "&bDesc=" + bDesc + "&bEmail=" + bEmail + "&bWebsite=" + bWebsite + "&bLat=" + bLat + "&bLon=" + bLon + "&bCategory=" + bCategory + "&bPhone=" + bPhone + "&bAltPhone=" + bAltPhone + "&bAltPhone2=" + bAltPhone + "&bProducts=" + bProducts + "&facebook=" + facebook + "&twitter=" + twitter;
			$.ajax({
				"type": "POST",
				"url": "http://api.sjdsdirectory.com/addbusiness/",
				"data": data,
				"success": function(msg){
					if (msg == 0){
						alert("NOT ADDED.  Either it is already been inputted or, well...something went wrong");
					} else if (msg == 2){
						alert("Latitude and Longitudes are Repeats.  Information not entered");
					}
				}
			})

		});

		$("#editbtn").click(function(e){
			e.preventDefault();
			bid = $("#place_select2").val();
			get_biz(bid);
		})
		
		$("#delbtn").click(function(e){
			e.preventDefault();
			bid = $("#place_select2").val();
			del_biz(bid);
		})
	});
</script>


</body>
</html>
